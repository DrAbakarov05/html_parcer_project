# HTML Table Parser

Парсер для извлечения таблиц из HTML файлов и сохранения их в Excel формат.

## Установка зависимостей

```bash
pip install -r requirements.txt
```

## Использование

1. Поместите HTML-файл с таблицами в папку `data/` под именем `test.html`.
2. Запустите скрипт:

```bash
python src/Html_parser.py
```

При необходимости вы можете изменить пути к входному и выходному файлам в `src/Html_parser.py` (переменные `data_dir`, `html_file`, `output_excel_path`).

## Функции

- `parse_html_tables(source)` — парсит все таблицы из HTML с помощью pandas
- `parse_html_table(html, index)` — парсит конкретную таблицу с помощью BeautifulSoup
- Автоматическое сохранение всех найденных таблиц в Excel-файл

## Результат

Скрипт создаст файл `data/all_tables2.xlsx` с отдельными листами для каждой найденной таблицы.

## Пример HTML структуры

```html
<table>
    <tr>
        <th>Заголовок 1</th>
        <th>Заголовок 2</th>
    </tr>
    <tr>
        <td>Данные 1</td>
        <td>Данные 2</td>
    </tr>
</table>
```

## Конвертер TXT → HTML

Инструмент для конвертации `.txt` файла, содержащего HTML-разметку, в полноценный `.html` документ.

### Возможности

- Если во входном `.txt` уже есть полный документ (`<html>` или `<!doctype html>`), содержимое сохраняется без изменений.
- Если во входном файле только HTML-фрагмент (например, `<table>...</table>`), он автоматически оборачивается в минимальный HTML-шаблон с `utf-8` и заголовком.
- Автоматическая попытка чтения файла в нескольких кодировках: UTF-8 → CP1251 → ISO-8859-1.
- Сохранение результата в `UTF-8`.

### Запуск

```bash
python -m src.txt_to_html path/to/input.txt -o path/to/output.html --title "Мой документ"
```

- `input` (необязательный): путь к входному `.txt` файлу. Если не указан — берётся `data/test.txt`.
- `-o, --output` (необязательно): путь к выходному `.html` файлу; по умолчанию рядом с входным с тем же именем
- `--title` (необязательно): заголовок HTML-документа при оборачивании фрагмента; по умолчанию — имя файла

### Примеры

```bash
python -m src.txt_to_html data/test.txt -o data/test.html --title "Демо"
```

```bash
# Запуск без аргументов — возьмёт data/test.txt и создаст data/test.html
python -m src.txt_to_html
```

По умолчанию результат сохраняется в той же папке, что и входной файл, с расширением `.html`.